---
phase: 15-task-checkbox-sync-exam-progress-bars-and-push-to-next-day-foundation
plan: 02
type: execute
wave: 2
depends_on: [15-01-PLAN.md]
files_modified: []
autonomous: true
requirements: []

must_haves:
  truths:
    - "Phase 15 implementation verified: checkbox sync and defer work end-to-end"
    - "No regression: login, load calendar, edit task, regenerate still work"
  artifacts: []
---

<objective>
Verify Phase 15 implementation and run a short regression check.

Purpose: Confirm task checkbox sync and exam progress bars update correctly when marking blocks done/undone; confirm defer moves block to next day and UI refreshes; ensure existing flows (login, calendar load, task edit, regenerate) are unchanged.

Output: Verification steps executed, any deviations documented in SUMMARY.
</objective>

<context>
@.planning/phases/15-task-checkbox-sync-exam-progress-bars-and-push-to-next-day-foundation/15-01-PLAN.md
@.planning/ROADMAP.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verification — checkbox sync and exam progress</name>
  <files></files>
  <action>
Start backend server. With a test user that has exams and schedule: (1) GET /exams and note done_count for an exam. (2) Mark one schedule block for that exam as done via PATCH /tasks/block/{id}/done. (3) GET /exams again — if that block was the last incomplete block for any task, that task's exam should show increased done_count and progress bar percentage. (4) PATCH /tasks/block/{id}/undone — done_count should decrease. Use curl or a small script; if no auth token available, document "Manual verification: mark block done in UI, confirm exam card progress bar updates."
  </action>
  <verify>
    Backend starts without error. Either automated curl checks pass or verification steps documented for manual run.
  </verify>
  <done>
    - Checkbox sync verified (task status and exam done_count in sync with block completed)
    - Exam progress bars reflect block completion state
  </done>
</task>

<task type="auto">
  <name>Task 2: Verification — defer endpoint and UI refresh</name>
  <files></files>
  <action>
Call POST /tasks/block/{id}/defer with valid auth. Check response 200 and body has day_date. Query DB or GET /schedule: block's day_date is next calendar day, is_delayed=1. If frontend defer button was added, document: "Manual: click Defer on a block, confirm it appears on next day in calendar."
  </action>
  <verify>
    Defer endpoint returns success; block moved in DB/schedule response.
  </verify>
  <done>
    - Defer API moves block to next day
    - Frontend defer flow refreshes calendar (manual check if no E2E)
  </done>
</task>

<task type="checkpoint:human-verify">
  <name>Task 3: Human verification — full flow in browser</name>
  <files></files>
  <action>
User opens app, logs in, loads calendar. Marks a block done via checkbox — exam card progress bar updates. Marks it undone — progress bar updates. Uses Defer on a block — block appears next day. Confirms no regression: login, today focus, task edit, regenerate still work.
  </action>
  <verify>
    User confirms in browser.
  </verify>
  <done>
    - Human verified: checkbox sync, progress bars, defer, no regression
  </done>
</task>

<task type="auto">
  <name>Task 4: Regression — critical endpoints respond</name>
  <files></files>
  <action>
Ensure backend health and key routes respond: GET /health (or /), GET /exams (with auth), GET /schedule (with auth), POST /regenerate-schedule (with auth). No 500s. Document result.
  </action>
  <verify>
    curl or script; all return 200 or expected auth challenge.
  </verify>
  <done>
    - Health and auth-protected endpoints respond without 500
  </done>
</task>
</tasks>

<verification>
- Phase 15 features work; no regressions on login, calendar, edit, regenerate.
</verification>

<success_criteria>
- Verification and regression tasks completed; human checkpoint satisfied or auto-approved per config.
</success_criteria>
