---
requirements: ["PROF-01", "PROF-02"]
depends_on: ["07-02"]
must_haves:
  truths:
    - New users are automatically routed to onboarding.
    - Returning users skip onboarding and land on the dashboard.
    - Profile preferences can be updated via a dedicated Settings UI.
  artifacts:
    - path: "frontend/js/app.js"
      provides: "auth routing and onboarding check"
    - path: "frontend/js/auth.js"
      provides: "handleOnboardingSubmit logic"
    - path: "frontend/index.html"
      provides: "Settings section for profile management"
  key_links:
    - from: "backend/auth/routes.py"
      to: "frontend/js/app.js"
      via: "onboarding_completed=0 response"
---

# Plan: Phase 07-03 - Auth Integration & Profile Settings

Wire the onboarding wizard to the authentication flow and implement post-onboarding profile management.

<task id="auth_wiring">
  <files>
    <file>backend/auth/routes.py</file>
    <file>frontend/js/app.js</file>
  </files>
  <action>
    Backend: Set `onboarding_completed = 0` for new users in `register` and `google_callback`.
    Frontend: In `initApp`, check `user.onboarding_completed`. If `0`, show `screen-onboarding`.
    Update `auth.js` login/register handlers to do the same check.
  </action>
  <verify>
    Register a new user and verify they are automatically shown the onboarding wizard.
  </verify>
  <done>[x] true</done>
</task>

<task id="onboarding_submission">
  <files>
    <file>frontend/js/auth.js</file>
  </files>
  <action>
    Implement `handleOnboardingSubmit()` to call `PATCH /users/me` with all captured profile data and set `onboarding_completed = 1`.
    Trigger the "Profile Success" animation before redirecting to `screen-dashboard`.
  </action>
  <verify>
    Complete the wizard and verify that the success animation plays before redirection to the dashboard.
  </verify>
  <done>[x] true</done>
</task>

<task id="profile_settings_ui">
  <files>
    <file>frontend/index.html</file>
  </files>
  <action>
    Add a "Settings" or "Profile" modal/section to the dashboard where users can view and update their profile preferences (Hobby, Sleep/Wake, etc.).
  </action>
  <verify>
    Open settings, change a value (e.g., Neto Hours), save, and verify it persists after a page refresh.
  </verify>
  <done>[x] true</done>
</task>
