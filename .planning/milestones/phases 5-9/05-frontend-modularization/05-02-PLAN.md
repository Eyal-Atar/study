---
phase: 05-frontend-modularization
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified: [frontend/js/tasks.js, frontend/js/calendar.js, frontend/js/brain.js]
autonomous: true
requirements: [FE-MOD]
user_setup: []

must_haves:
  truths:
    - "tasks.js manages exam and task-related CRUD operations"
    - "calendar.js handles the rendering of the study roadmap and today focus view"
    - "brain.js manages the chat interface logic for adjusting schedules"
  artifacts:
    - path: "frontend/js/tasks.js"
      provides: "Exam and Task logic (loadExams, deleteExam, toggleDone, generateRoadmap)"
    - path: "frontend/js/calendar.js"
      provides: "Rendering functions (renderCalendar, renderTodayFocus, renderExamLegend)"
    - path: "frontend/js/brain.js"
      provides: "Brain chat logic (sendBrainMessage, addChatBubble)"
  key_links:
    - from: "frontend/js/tasks.js"
      to: "frontend/js/store.js"
      via: "import currentTasks/currentExams accessors"
    - from: "frontend/js/calendar.js"
      to: "frontend/js/store.js"
      via: "import exam data for rendering"
---

<objective>
Refactor remaining feature logic from the monolithic app.js into dedicated ES6 modules for exams, tasks, calendar rendering, and brain chat.

Purpose: Complete the feature modularization while following the store/ui patterns established in Wave 1.
Output: tasks.js, calendar.js, and brain.js modules.
</objective>

<execution_context>
@/Users/eyalatar/.gemini/get-shit-done/workflows/execute-plan.md
@/Users/eyalatar/.gemini/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/5-CONTEXT.md
@frontend/js/app.js
@.planning/phases/05-frontend-modularization/05-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create tasks.js module</name>
  <files>frontend/js/tasks.js</files>
  <action>
    - Create `frontend/js/tasks.js` and move exam/task logic from `app.js` (`loadExams`, `renderExamCards`, `updateStats`, `deleteExam`, `toggleDone`, `generateRoadmap`).
    - Move "Add Exam Modal" logic (`openAddExamModal`, `closeAddExamModal`, `handleFileSelect`, etc.) to this module.
    - Import state accessors from `store.js` and UI helpers from `ui.js`.
    - Implement an `initTasks()` function to bind modal and task action listeners.
  </action>
  <verify>tasks.js exists and contain all exported feature logic.</verify>
  <done>Exams and tasks logic is isolated in its own module.</done>
</task>

<task type="auto">
  <name>Task 2: Create calendar.js and brain.js modules</name>
  <files>frontend/js/calendar.js, frontend/js/brain.js</files>
  <action>
    - Create `frontend/js/calendar.js` and move rendering functions (`renderCalendar`, `renderTodayFocus`, `renderExamLegend`, `examColorClass`). This module should focus purely on view rendering based on state.
    - Create `frontend/js/brain.js` and move brain chat logic (`sendBrainMessage`, `addChatBubble`).
    - Both modules should import state and UI helpers and expose necessary functions or an `init()` function for event listeners.
  </action>
  <verify>calendar.js and brain.js exist with correct imports/exports.</verify>
  <done>Calendar rendering and brain chat logic are fully modularized.</done>
</task>

</tasks>

<verification>
Ensure all core features previously in app.js have been migrated to their respective modules and no business logic is left behind.
</verification>

<success_criteria>
- tasks.js manages exam/task CRUD and modals.
- calendar.js exports rendering functions for the roadmap.
- brain.js handles chat interaction with the AI backend.
</success_criteria>

<output>
After completion, create `.planning/phases/05-frontend-modularization/05-02-SUMMARY.md`
</output>
