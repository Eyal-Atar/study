---
phase: 05-frontend-modularization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [frontend/js/store.js, frontend/js/ui.js, frontend/js/auth.js]
autonomous: true
requirements: [FE-MOD]
user_setup: []

must_haves:
  truths:
    - "store.js manages global state like currentUser and authToken"
    - "ui.js provides reusable screen switching and error display logic"
    - "auth.js handles login/register/logout logic with its own listener binding"
  artifacts:
    - path: "frontend/js/store.js"
      provides: "Global state getters/setters"
    - path: "frontend/js/ui.js"
      provides: "UI helper functions (showScreen, showError, shakeEl)"
    - path: "frontend/js/auth.js"
      provides: "initAuth() for binding listeners and auth logic"
  key_links:
    - from: "frontend/js/auth.js"
      to: "frontend/js/store.js"
      via: "import state getters/setters"
    - from: "frontend/js/auth.js"
      to: "frontend/js/ui.js"
      via: "import showError/shakeEl"
---

<objective>
Establish the foundational modules for state management, UI helpers, and authentication to replace monolithic global functions.

Purpose: Isolate state and common UI logic to prevent scope pollution and prepare for modular entry point.
Output: store.js, ui.js, and auth.js modules ready for integration.
</objective>

<execution_context>
@/Users/eyalatar/.gemini/get-shit-done/workflows/execute-plan.md
@/Users/eyalatar/.gemini/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/5-CONTEXT.md
@frontend/js/app.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create store.js and ui.js foundation</name>
  <files>frontend/js/store.js, frontend/js/ui.js</files>
  <action>
    - Create `frontend/js/store.js` and move global variables from `app.js` (API, authToken, currentUser, etc.) into a centralized store object. Export getters and setters (e.g., `setAuthToken`, `getCurrentUser`).
    - Create `frontend/js/ui.js` and move common UI helper functions from `app.js` (`showScreen`, `shakeEl`, `showError`, `hideError`, `spawnConfetti`). Use `store.js` if state is needed.
    - Export these functions using ES6 export syntax.
  </action>
  <verify>Files exist and contain exported functions from app.js.</verify>
  <done>store.js and ui.js are created with complete logic migrated from app.js.</done>
</task>

<task type="auto">
  <name>Task 2: Create auth.js module</name>
  <files>frontend/js/auth.js</files>
  <action>
    - Create `frontend/js/auth.js` and move all authentication-related logic from `app.js` (`handleLogin`, `handleRegister`, `handleLogout`, `regNext`).
    - Import state and UI helpers from `store.js` and `ui.js`.
    - Implement an `initAuth()` function that will eventually attach event listeners to auth-related elements in the DOM (login/register buttons).
    - Note: This module should NOT rely on global scope for its internal logic.
  </action>
  <verify>auth.js exists and exports initAuth and other necessary helpers.</verify>
  <done>Authentication logic is fully modularized in auth.js.</done>
</task>

</tasks>

<verification>
Check that the created modules are correctly importing/exporting and contain all relevant logic from the monolithic app.js.
</verification>

<success_criteria>
- store.js exports API URL and state accessors.
- ui.js exports all visual utility functions.
- auth.js contains all login/register logic and an initAuth() function.
</success_criteria>

<output>
After completion, create `.planning/phases/05-frontend-modularization/05-01-SUMMARY.md`
</output>
